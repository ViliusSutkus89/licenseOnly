plugins {
    id 'com.android.library'
    id 'maven-publish'
    id 'signing'
}

group = 'com.viliussutkus89.licenseOnly'

android {
    compileSdk 32
    defaultConfig {
        minSdk 16
        targetSdk 32

        versionCode 1
        versionName '0.18.14'
    }
}

dependencies {
    // License only dependencies. To add cpp dependencies to POM
    implementation 'com.viliussutkus89.licenseOnly:pdf2htmlEX:v0.18.7-poppler-0.81.0'

    // Dependencies of pdf2htmlEX
    implementation 'com.viliussutkus89.licenseOnly:cairo:1.17.4'
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:FontForge:20170731'
    implementation 'com.viliussutkus89.licenseOnly:poppler:0.81.0'
    implementation 'com.viliussutkus89.licenseOnly:SymbolAndZapfDingbatsFonts:1.00'

    // Dependencies of cairo
    implementation 'com.viliussutkus89.licenseOnly:fontconfig:2.13.93'
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:GLib:2.66.4'
    implementation 'com.viliussutkus89.licenseOnly:libiconv:1.16'
    implementation 'com.viliussutkus89.licenseOnly:libpng:1.6.37'
    implementation 'com.viliussutkus89.licenseOnly:libxml:2.9.9'
    implementation 'com.viliussutkus89.licenseOnly:pixman:0.40.0'

    // Dependencies of FreeType
    implementation 'com.viliussutkus89.licenseOnly:libpng:1.6.37'

    // Dependencies of FontForge
    implementation 'com.viliussutkus89.licenseOnly:cairo:1.17.4'
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:GLib:2.66.4'
    implementation 'com.viliussutkus89.licenseOnly:libiconv:1.16'
    implementation 'com.viliussutkus89.licenseOnly:libjpeg-turbo:2.0.4'
    implementation 'com.viliussutkus89.licenseOnly:libpng:1.6.37'
    implementation 'com.viliussutkus89.licenseOnly:libtool:2.4.6'
    implementation 'com.viliussutkus89.licenseOnly:libuninameslist:20190701'
    implementation 'com.viliussutkus89.licenseOnly:libxml:2.9.9'
    implementation 'com.viliussutkus89.licenseOnly:pango:1.48.0'
    implementation 'com.viliussutkus89.licenseOnly:proxy-libintl:0.2'

    // Dependencies of poppler
    implementation 'com.viliussutkus89.licenseOnly:cairo:1.17.4'
    implementation 'com.viliussutkus89.licenseOnly:fontconfig:2.13.93'
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:GLib:2.66.4'
    implementation 'com.viliussutkus89.licenseOnly:LCMS:2.9'
    implementation 'com.viliussutkus89.licenseOnly:libjpeg-turbo:2.0.4'
    implementation 'com.viliussutkus89.licenseOnly:libpng:1.6.37'
    implementation 'com.viliussutkus89.licenseOnly:OpenJPEG:2.3.1'
    implementation 'com.viliussutkus89.licenseOnly:LibTIFF:4.1.0'
    implementation 'com.viliussutkus89.licenseOnly:poppler-data:0.4.9'

    // Dependencies of fontconfig
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:libexpat:2.2.10'

    // Dependencies of GLib
    implementation 'com.viliussutkus89.licenseOnly:libiconv:1.16'
    implementation 'com.viliussutkus89.licenseOnly:libffi:3.3'
    implementation 'com.viliussutkus89.licenseOnly:proxy-libintl:0.2'

    // Dependencies of libiconv
    // none

    // Dependencies of libxml
    implementation 'com.viliussutkus89.licenseOnly:libiconv:1.16'

    // Dependencies of pixman
    implementation 'com.viliussutkus89.licenseOnly:libpng:1.6.37'
    implementation 'com.viliussutkus89.licenseOnly:GLib:2.66.4'

    // Dependencies of libpng
    // none

    // Dependencies of libjpeg-turbo
    // none

    // Dependencies of libtool
    // none

    // Dependencies of libuninameslist
    // none

    // Dependencies of pango
    implementation 'com.viliussutkus89.licenseOnly:cairo:1.17.4'
    implementation 'com.viliussutkus89.licenseOnly:fontconfig:2.13.93'
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:FriBiDi:1.0.7'
    implementation 'com.viliussutkus89.licenseOnly:GLib:2.66.4'
    implementation 'com.viliussutkus89.licenseOnly:HarfBuzz:2.6.6'

    // Dependencies of proxy-libintl
    // none

    // Dependencies of LCMS
    implementation 'com.viliussutkus89.licenseOnly:libjpeg-turbo:2.0.4'
    implementation 'com.viliussutkus89.licenseOnly:LibTIFF:4.1.0'

    // Dependencies of OpenJPEG
    implementation 'com.viliussutkus89.licenseOnly:LCMS:2.9'
    implementation 'com.viliussutkus89.licenseOnly:libjpeg-turbo:2.0.4'
    implementation 'com.viliussutkus89.licenseOnly:libpng:1.6.37'
    implementation 'com.viliussutkus89.licenseOnly:LibTIFF:4.1.0'

    // Dependencies of LibTIFF
    implementation 'com.viliussutkus89.licenseOnly:libjpeg-turbo:2.0.4'

    // Dependencies of libexpat
    // none

    // Dependencies of libffi
    // none

    // Dependencies of FriBiDi
    // none

    // Dependencies of HarfBuzz
    implementation 'com.viliussutkus89.licenseOnly:cairo:1.17.4'
    implementation 'com.viliussutkus89.licenseOnly:fontconfig:2.13.93'
    implementation 'com.viliussutkus89.licenseOnly:FreeType:2.10.4'
    implementation 'com.viliussutkus89.licenseOnly:GLib:2.66.4'
}

task sourceJar(type: Jar) {
    archiveClassifier.set('sources')
}

task javadocJar(type: Jar) {
    archiveClassifier.set('javadoc')
}

afterEvaluate {
    publishing {
        publications {
            release(MavenPublication) {
                from components.release

                artifactId project.name
                version = android.defaultConfig.versionName

                artifact sourceJar
                artifact javadocJar

                pom {
                    name = project.name
                    description = 'Dependency tree for pdfh2mltEX-Android'
                    url = 'https://github.com/ViliusSutkus89/licenseOnly'
                    packaging = 'aar'
                    inceptionYear = '2021'
                    licenses {
                        license {
                            name = 'GPLv3'
                            url = 'https://www.gnu.org/licenses/gpl-3.0.html'
                            distribution = 'repo'
                        }
                    }
                    scm {
                        url = 'https://github.com/ViliusSutkus89/licenseOnly'
                        connection = 'https://github.com/ViliusSutkus89/licenseOnly.git'
                    }
                    developers {
                        developer {
                            id = "ViliusSutkus89"
                            name = "Vilius Sutkus '89"
                            email = "ViliusSutkus89@gmail.com"
                        }
                    }
                }
            }
        }
    }

    if (System.getenv('SIGNING_KEY')) {
        signing {
            required { true }
            useInMemoryPgpKeys(System.getenv('SIGNING_KEY'), System.getenv('SIGNING_PASS'))
            sign publishing.publications.release
        }
    }
}
